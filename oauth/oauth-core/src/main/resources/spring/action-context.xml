<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="flowDefLoader" class="com.junbo.langur.core.webflow.definition.FlowDefLoaderImpl"/>

    <bean id="stateRepository" class="com.junbo.langur.core.webflow.state.InMemoryStateRepository"/>

    <bean id="stateExecutorFactory" class="com.junbo.langur.core.webflow.executor.StateExecutorFactoryImpl"/>

    <bean id="flowExecutor" class="com.junbo.langur.core.webflow.executor.FlowExecutorImpl">
        <property name="flowDefLoader" ref="flowDefLoader"/>
        <property name="stateExecutorFactory" ref="stateExecutorFactory"/>
        <property name="stateRepository" ref="stateRepository"/>
    </bean>

    <bean id="generateResponse" class="com.junbo.oauth.core.action.GenerateAccessTokenResponse"/>

    <bean id="authenticateClient" class="com.junbo.oauth.core.action.AuthenticateClient">
        <property name="clientRepository" ref="clientRepository"/>
    </bean>

    <bean id="authenticateUser" class="com.junbo.oauth.core.action.AuthenticateUser">
        <property name="userService" ref="userService"/>
    </bean>

    <bean id="buildRedirectUri" class="com.junbo.oauth.core.action.BuildRedirectUri"/>

    <bean id="clearLoginCookies" class="com.junbo.oauth.core.action.ClearLoginCookies">
        <property name="loginStateRepository" ref="loginStateRepository"/>
        <property name="rememberMeTokenRepository" ref="rememberMeTokenRepository"/>
    </bean>

    <bean id="consentError" class="com.junbo.oauth.core.action.BuildRedirectUri">
        <property name="errorMessage" value="consent_requried"/>
    </bean>

    <bean id="generateAccessTokenResponse" class="com.junbo.oauth.core.action.GenerateAccessTokenResponse"/>

    <bean id="getAccessTokenInfo" class="com.junbo.oauth.core.action.GetAccessTokenInfo">
        <property name="tokenService" ref="tokenService"/>
    </bean>

    <bean id="grantAuthorizationCode" class="com.junbo.oauth.core.action.GrantAuthorizationCode">
        <property name="authorizationCodeRepository" ref="authorizationCodeRepository"/>
        <property name="defaultExpiration" value="${oauth.core.authorizationCode.default.expiration}"/>
    </bean>

    <bean id="grantIdToken" class="com.junbo.oauth.core.action.GrantIdToken">
        <property name="tokenService" ref="tokenService"/>
    </bean>

    <bean id="grantImplicitAccessToken" class="com.junbo.oauth.core.action.GrantImplicitAccessToken">
        <property name="tokenService" ref="tokenService"/>
    </bean>

    <bean id="grantRefreshToken" class="com.junbo.oauth.core.action.GrantRefreshToken">
        <property name="tokenService" ref="tokenService"/>
    </bean>

    <bean id="grantRememberMeToken" class="com.junbo.oauth.core.action.GrantRememberMeToken">
        <property name="rememberMeTokenRepository" ref="rememberMeTokenRepository"/>
        <property name="defaultRememberMeTokenExpiration" value="${oauth.core.rememberMeToken.default.expiration}"/>
    </bean>

    <bean id="grantTokenByCode" class="com.junbo.oauth.core.action.GrantTokenByCode">
        <property name="tokenService" ref="tokenService"/>
        <property name="authorizationCodeRepository" ref="authorizationCodeRepository"/>
    </bean>

    <bean id="grantTokenByPassword" class="com.junbo.oauth.core.action.GrantTokenByPassword">
        <property name="tokenService" ref="tokenService"/>
    </bean>

    <bean id="grantTokenByRefreshToken" class="com.junbo.oauth.core.action.GrantTokenByRefreshToken">
        <property name="tokenService" ref="tokenService"/>
    </bean>

    <bean id="loadIdTokenHint" class="com.junbo.oauth.core.action.LoadIdTokenHint">
        <property name="tokenService" ref="tokenService"/>
    </bean>

    <bean id="loadLoginState" class="com.junbo.oauth.core.action.LoadLoginState">
        <property name="loginStateRepository" ref="loginStateRepository"/>
    </bean>

    <bean id="loadRememberMeToken" class="com.junbo.oauth.core.action.LoadRememberMeToken">
        <property name="rememberMeTokenRepository" ref="rememberMeTokenRepository"/>
    </bean>

    <bean id="logout" class="com.junbo.oauth.core.action.Logout">
        <property name="loginStateRepository" ref="loginStateRepository"/>
        <property name="rememberMeTokenRepository" ref="rememberMeTokenRepository"/>
        <property name="tokenService" ref="tokenService"/>
        <property name="clientRepository" ref="clientRepository"/>
        <property name="confirmationUri" value="${oauth.core.portal.logoutConfirmationUri}"/>
    </bean>

    <bean id="redirect" class="com.junbo.oauth.core.action.Redirect"/>

    <bean id="saveConsent" class="com.junbo.oauth.core.action.SaveConsent">
        <property name="consentRepository" ref="consentRepository"/>
    </bean>

    <bean id="saveLoginState" class="com.junbo.oauth.core.action.SaveLoginState">
        <property name="loginStateRepository" ref="loginStateRepository"/>
    </bean>

    <bean id="validateClient" class="com.junbo.oauth.core.action.ValidateClient">
        <property name="clientRepository" ref="clientRepository"/>
    </bean>

    <bean id="validateConsent" class="com.junbo.oauth.core.action.ValidateConsent">
        <property name="consentRepository" ref="consentRepository"/>
        <property name="consentUri" value="${oauth.core.portal.consentUri}"/>
    </bean>

    <bean id="validateDisplay" class="com.junbo.oauth.core.action.ValidateDisplay">
        <property name="defaultDisplay" value="PAGE"/>
    </bean>

    <bean id="validateGrantType" class="com.junbo.oauth.core.action.ValidateGrantType"/>

    <bean id="validateLoginState" class="com.junbo.oauth.core.action.ValidateLoginState">
        <property name="loginUri" value="${oauth.core.portal.loginUri}"/>
    </bean>

    <bean id="validateMaxAge" class="com.junbo.oauth.core.action.ValidateMaxAge"/>

    <bean id="validateNonce" class="com.junbo.oauth.core.action.ValidateNonce"/>

    <bean id="validatePrompt" class="com.junbo.oauth.core.action.ValidatePrompt"/>

    <bean id="validateRedirectUri" class="com.junbo.oauth.core.action.ValidateRedirectUri"/>

    <bean id="validateResponseType" class="com.junbo.oauth.core.action.ValidateResponseType"/>

    <bean id="validateScope" class="com.junbo.oauth.core.action.ValidateScope"/>

</beans>
