<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:wf="http://www.junbo.com/schema/webflow"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.junbo.com/schema/webflow http://www.junbo.com/schema/webflow-config/webflow.xsd">

    <wf:flow id="forgetPasswordFlow">

        <wf:action-state id="START">
            <wf:action ref="validateLocale" />
            <wf:transition on="*" to="REDIRECT_TO_FORGET_LOGIN_INFO"/>
        </wf:action-state>

        <wf:view-state id="REDIRECT_TO_FORGET_LOGIN_INFO">
            <wf:on-render>
                <wf:action ref="redirectToForgetLoginInfo"/>
            </wf:on-render>
            <wf:transition on="*" to="FORGET_LOGIN_INFO_VIEW"/>
        </wf:view-state>

        <wf:view-state id="FORGET_LOGIN_INFO_VIEW">
            <wf:on-render>
                <wf:action ref="forgetLoginInfoView"/>
            </wf:on-render>
            <wf:transition on="next" to="REDIRECT_TO_CHOOSE_RESET_METHOD">
                <wf:action ref="validateForgetPasswordEmail"/>
            </wf:transition>
        </wf:view-state>

        <wf:view-state id="REDIRECT_TO_CHOOSE_RESET_METHOD">
            <wf:on-render>
                <wf:action ref="redirectToChooseResetMethod"/>
            </wf:on-render>
            <wf:transition on="*" to="CHOOSE_RESET_METHOD_VIEW"/>
        </wf:view-state>

        <wf:view-state id="CHOOSE_RESET_METHOD_VIEW">
            <wf:on-render>
                <wf:action ref="chooseResetMethodView"/>
            </wf:on-render>
            <wf:transition on="email" to="REDIRECT_TO_EMAIL_SENT"/>
        </wf:view-state>

        <wf:view-state id="REDIRECT_TO_EMAIL_SENT">
            <wf:on-render>
                <wf:action ref="redirectToEmailSent"/>
            </wf:on-render>
            <wf:transition on="*" to="EMAIL_SENT_VIEW"/>
        </wf:view-state>

        <wf:end-state id="EMAIL_SENT_VIEW">
            <wf:on-entry>
                <wf:action ref="emailSentView"/>
            </wf:on-entry>
        </wf:end-state>
    </wf:flow>

    <bean id="validateForgetPasswordEmail" class="com.junbo.oauth.core.action.ValidateForgetPasswordEmail">
        <property name="userPersonalInfoResource" ref="oauth_userPersonalInfoResource" />
    </bean>

    <bean id="verifySMSCodeView" class="com.junbo.oauth.core.view.VerifySMSCodeView" />

    <bean id="redirectToEmailSent" class="com.junbo.oauth.core.view.RedirectToPage">
        <property name="pageUrl" value="${oauth.core.portal.emailSentUri}"/>
    </bean>

    <bean id="emailSentView" class="com.junbo.oauth.core.view.EmailSentView" />

    <bean id="redirectToChooseResetMethod" class="com.junbo.oauth.core.view.RedirectToPage">
        <property name="pageUrl" value="${oauth.core.portal.chooseResetMethodUri}"/>
    </bean>

    <bean id="chooseResetMethodView" class="com.junbo.oauth.core.view.ChooseResetMethodView" />

    <bean id="redirectToForgetLoginInfo" class="com.junbo.oauth.core.view.RedirectToPage">
        <property name="pageUrl" value="${oauth.core.portal.forgetLoginInfoUri}"/>
    </bean>

    <bean id="forgetLoginInfoView" class="com.junbo.oauth.core.view.ForgetLoginInfoView"/>

</beans>
