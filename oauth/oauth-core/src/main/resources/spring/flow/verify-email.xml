<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:wf="http://www.junbo.com/schema/webflow"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.junbo.com/schema/webflow http://www.junbo.com/schema/webflow-config/webflow.xsd">

    <wf:flow id="emailVerifyFlow">
        <wf:view-state id="REDIRECT_TO_VERIFY">
            <wf:on-render>
                <wf:action ref="redirectToVerifyResult"/>
            </wf:on-render>
            <wf:transition on="*" to="EMAIL_VERIFY_VIEW"/>
        </wf:view-state>

        <wf:end-state id="EMAIL_VERIFY_VIEW">
            <wf:on-entry>
                <wf:action ref="verifyEmail"/>
                <wf:action ref="emailVerifyView"/>
            </wf:on-entry>
        </wf:end-state>
    </wf:flow>

    <bean id="verifyEmail" class="com.junbo.oauth.core.action.VerifyEmail">
        <property name="emailVerifyCodeRepository" ref="emailVerifyCodeRepository"/>
        <property name="userPiiResource" ref="userPiiResource"/>
    </bean>

    <bean id="emailVerifyView" class="com.junbo.oauth.core.view.EmailVerifyView"/>

    <bean id="redirectToVerifyResult" class="com.junbo.oauth.core.view.RedirectToVerifyResult">
        <property name="pageUrl" value="${oauth.core.portal.verifyUri}"/>
    </bean>
</beans>