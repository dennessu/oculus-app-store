general:
  branches:
    only:
      - master
      - release

machine:
  java:
    version: oraclejdk7
  services:
    - docker

# checkout:

dependencies:
  cache_directories:
    - ~/.m2
  override:
    - docker info

database:
  override:
    - ./setupdb.sh
  post:
    - GRADLE_OPTS="$GRADLE_OPTS -Xmx512m -XX:MaxPermSize=256m" ./build.sh -x build --parallel-threads=1
    - ./dataloader.sh

test:
  override:
    - ./test.sh -r

#deployment:
