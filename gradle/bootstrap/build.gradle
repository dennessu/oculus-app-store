task createWrapper(type: Wrapper) {
    gradleVersion = '1.11'
}

apply plugin: 'idea'
apply plugin: 'maven'
apply plugin: 'groovy'

group = "com.junbo.gradle"
version = property("${project.name}-version")

repositories {
    mavenLocal()
    mavenCentral()
    jcenter()
}

sourceCompatibility = 1.7
targetCompatibility = 1.7

tasks.withType(Upload) {
    it.dependsOn 'build'
}

dependencies {
    compile gradleApi()
    compile localGroovy()

    compile 'org.eclipse.jgit:org.eclipse.jgit:3.3.2.201404171909-r'

    testCompile 'org.testng:testng:6.8.7'
}

test {
    useTestNG()
}

idea {
    project {
        jdkName = 1.7
        languageLevel = 1.7
    }

    module {
        excludeDirs -= file("$buildDir")
        sourceDirs += file("$buildDir/generated-src")

        sourceDirs += file('src/main/java')
        sourceDirs += file('src/main/groovy')
        sourceDirs += file('src/main/resources')
        sourceDirs += file('src/main/webapp')
    }
}

defaultTasks 'clean', 'install'
