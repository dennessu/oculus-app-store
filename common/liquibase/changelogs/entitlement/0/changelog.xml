<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="1" author='NanXin' context="PREDEPLOY">
        <sql><![CDATA[
            create table entitlement_definition(
              entitlement_definition_id bigint not null,
              developer_id bigint not null,
              type smallint not null,
              entitlement_group varchar(64) default null,
              tag varchar(64) not null,
              created_by varchar(32) default null,
              modified_by varchar(32) default null,
              created_time timestamp not null,
              modified_time timestamp not null,
              status varchar(32) default null,
              tracking_uuid uuid UNIQUE,
              primary key (entitlement_definition_id)
            );
            create table entitlement (
              entitlement_id bigint not null,
              user_id bigint not null,
              developer_id bigint not null,
              offer_id varchar(64) default null,
              type smallint not null,
              entitlement_group varchar(64) default null,
              tag varchar(64) not null,
              status smallint not null,
              grant_time timestamp not null,
              expiration_time timestamp default null,
              consumable boolean default null,
              use_count bigint not null,
              entitlement_definition_id bigint not null,
              managed_lifecycle boolean default null,
              status_reason varchar(32) default null,
              created_by varchar(32) default null,
              modified_by varchar(32) default null,
              created_time timestamp not null,
              modified_time timestamp not null,
              tracking_uuid uuid UNIQUE,
              primary key (entitlement_id)
            );
            create table entitlement_history (
              entitlement_history_id SERIAL,
              action varchar(32) not null,
              entitlement_id bigint not null,
              entitlement_definition_id bigint not null,
              user_id bigint not null,
              offer_id varchar(64) default null,
              developer_id bigint not null,
              type smallint not null,
              entitlement_group varchar(64) default null,
              tag varchar(64) not null,
              status smallint not null,
              grant_time timestamp not null,
              expiration_time timestamp default null,
              consumable boolean default null,
              use_count bigint not null,
              managed_lifecycle boolean default null,
              status_reason varchar(32) default null,
              created_by varchar(32) default null,
              modified_by varchar(32) default null,
              created_time timestamp not null,
              modified_time timestamp not null,
              primary key (entitlement_history_id)
            );
            create sequence entitlement_history_id_sequence increment by 1 minvalue 1 no maxvalue start with 1;
                ]]>
        </sql>
    </changeSet>

</databaseChangeLog>