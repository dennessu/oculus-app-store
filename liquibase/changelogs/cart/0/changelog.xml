<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet author="fzhang@wan-san.com" id="0.0.1" context="PREDEPLOY">
        <sql><![CDATA[
create table cart (
  cart_id bigint not null,
  user_id bigint not null,
  user_logged_in boolean not null,
  client_id varchar(100) not null,
  cart_name	varchar(100) not null,
  resource_age int not null,
  properties varchar(4000) default null,
  created_time timestamp not null,
  updated_time timestamp not null,
  primary key (cart_id)
);
]]>
        </sql>
    </changeSet>

    <changeSet author="fzhang@wan-san.com" id="0.0.2" context="PREDEPLOY">
        <sql><![CDATA[
create unique index user_clientid_cartname_index on cart (user_id, client_id, cart_name);
]]>
        </sql>
    </changeSet>

    <changeSet author="fzhang@wan-san.com" id="0.0.3" context="PREDEPLOY">
        <sql><![CDATA[
create table cart_offer_item (
  cart_item_id bigint not null,
  cart_id bigint not null,
  status_id smallint not null,
  properties varchar(4000) default null,
  created_time timestamp not null,
  updated_time timestamp not null,
  offer_id bigint not null,
  quantity bigint not null,
  selected boolean not null,
  approved boolean default null,
  primary key (cart_item_id)
);
]]>
        </sql>
    </changeSet>

    <changeSet author="fzhang@wan-san.com" id="0.0.4" context="PREDEPLOY">
        <sql><![CDATA[
create index cart_id_status_id_offer_item on cart_offer_item (cart_id, status_id);
]]>
        </sql>
    </changeSet>

    <changeSet author="fzhang@wan-san.com" id="0.0.5" context="PREDEPLOY">
        <sql><![CDATA[
create table cart_coupon_item (
  cart_item_id bigint not null,
  cart_id bigint not null,
  status_id smallint not null,
  properties varchar(4000) default null,
  created_time timestamp not null,
  updated_time timestamp not null,
  coupon_code varchar(256) not null,
  primary key (cart_item_id)
);
]]>
        </sql>
    </changeSet>

    <changeSet author="fzhang@wan-san.com" id="0.0.6" context="PREDEPLOY">
        <sql><![CDATA[
create index cart_id_status_id_coupon_item on cart_coupon_item (cart_id, status_id);
]]>
        </sql>
    </changeSet>
</databaseChangeLog>
